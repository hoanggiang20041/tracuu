# HÆ°á»›ng dáº«n sá»­ dá»¥ng chá»©c nÄƒng gia háº¡n báº£o hÃ nh

## Tá»•ng quan

Há»‡ thá»‘ng gia háº¡n báº£o hÃ nh Ä‘Ã£ Ä‘Æ°á»£c cáº£i thiá»‡n Ä‘á»ƒ Ä‘áº£m báº£o khi admin duyá»‡t Ä‘Æ¡n yÃªu cáº§u gia háº¡n, ngÃ y báº£o hÃ nh sáº½ Ä‘Æ°á»£c tá»± Ä‘á»™ng cá»™ng thÃªm cho táº¥t cáº£ phiáº¿u báº£o hÃ nh cá»§a khÃ¡ch hÃ ng.

## CÃ¡c cáº£i tiáº¿n chÃ­nh

### 1. Sá»­a lá»—i logic duyá»‡t gia háº¡n
- **TrÆ°á»›c**: Chá»‰ tÃ¬m 1 phiáº¿u báº£o hÃ nh Ä‘áº§u tiÃªn
- **Sau**: TÃ¬m Táº¤T Cáº¢ phiáº¿u báº£o hÃ nh cá»§a khÃ¡ch hÃ ng
- **Káº¿t quáº£**: Táº¥t cáº£ phiáº¿u báº£o hÃ nh cá»§a khÃ¡ch Ä‘á»u Ä‘Æ°á»£c gia háº¡n

### 2. Cáº£i thiá»‡n UI quáº£n lÃ½ gia háº¡n
- **Status badges**: Hiá»ƒn thá»‹ tráº¡ng thÃ¡i rÃµ rÃ ng (Chá» duyá»‡t, ÄÃ£ duyá»‡t, Tá»« chá»‘i)
- **Action buttons**: Duyá»‡t, Tá»« chá»‘i, Xem chi tiáº¿t phiáº¿u báº£o hÃ nh
- **ThÃ´ng tin chi tiáº¿t**: Hiá»ƒn thá»‹ thá»i gian táº¡o, duyá»‡t, sá»‘ phiáº¿u Ä‘Æ°á»£c cáº­p nháº­t

### 3. ThÃªm chá»©c nÄƒng tá»« chá»‘i gia háº¡n
- **Confirm dialog**: XÃ¡c nháº­n trÆ°á»›c khi tá»« chá»‘i
- **Status tracking**: Theo dÃµi thá»i gian tá»« chá»‘i
- **UI feedback**: Hiá»ƒn thá»‹ tráº¡ng thÃ¡i tá»« chá»‘i

### 4. Cáº£i thiá»‡n thÃ´ng bÃ¡o
- **Chi tiáº¿t hÆ¡n**: Hiá»ƒn thá»‹ sá»‘ phiáº¿u Ä‘Æ°á»£c cáº­p nháº­t
- **ThÃ´ng tin khÃ¡ch hÃ ng**: TÃªn vÃ  ID khÃ¡ch hÃ ng
- **Sá»‘ ngÃ y gia háº¡n**: Sá»‘ ngÃ y Ä‘Æ°á»£c cá»™ng thÃªm

## CÃ¡ch sá»­ dá»¥ng

### 1. KhÃ¡ch hÃ ng táº¡o yÃªu cáº§u gia háº¡n
1. VÃ o trang `renew.html?id=KH001&name=TÃªnKhÃ¡ch`
2. Äiá»n thÃ´ng tin:
   - Sá»‘ ngÃ y muá»‘n gia háº¡n
   - Sá»‘ tiá»n thanh toÃ¡n
   - Ná»™i dung chuyá»ƒn khoáº£n
   - Upload hÃ³a Ä‘Æ¡n (tÃ¹y chá»n)
3. Nháº¥n "Gá»­i yÃªu cáº§u gia háº¡n"

### 2. Admin duyá»‡t yÃªu cáº§u gia háº¡n
1. VÃ o trang `admin.html`
2. Chá»n tab "YÃªu cáº§u gia háº¡n"
3. Xem danh sÃ¡ch yÃªu cáº§u chá» duyá»‡t
4. CÃ¡c thao tÃ¡c cÃ³ thá»ƒ thá»±c hiá»‡n:

#### **Xem chi tiáº¿t phiáº¿u báº£o hÃ nh** (ğŸ‘ï¸)
- Hiá»ƒn thá»‹ táº¥t cáº£ phiáº¿u báº£o hÃ nh cá»§a khÃ¡ch hÃ ng
- ThÃ´ng tin: TiÃªu Ä‘á», ngÃ y báº¯t Ä‘áº§u, ngÃ y káº¿t thÃºc
- GiÃºp admin hiá»ƒu rÃµ trÆ°á»›c khi duyá»‡t

#### **Duyá»‡t gia háº¡n** (âœ…)
- Tá»± Ä‘á»™ng cá»™ng ngÃ y cho Táº¤T Cáº¢ phiáº¿u báº£o hÃ nh cá»§a khÃ¡ch
- Cáº­p nháº­t ngÃ y káº¿t thÃºc = ngÃ y cÅ© + sá»‘ ngÃ y gia háº¡n
- LÆ°u thay Ä‘á»•i vÃ o database
- ÄÃ¡nh dáº¥u yÃªu cáº§u lÃ  "ÄÃ£ duyá»‡t"

#### **Tá»« chá»‘i gia háº¡n** (âŒ)
- Hiá»ƒn thá»‹ dialog xÃ¡c nháº­n
- ÄÃ¡nh dáº¥u yÃªu cáº§u lÃ  "Tá»« chá»‘i"
- KhÃ´ng thay Ä‘á»•i ngÃ y báº£o hÃ nh

### 3. Theo dÃµi káº¿t quáº£
- **ThÃ´ng bÃ¡o thÃ nh cÃ´ng**: Hiá»ƒn thá»‹ sá»‘ phiáº¿u Ä‘Æ°á»£c cáº­p nháº­t
- **UI cáº­p nháº­t**: Báº£ng gia háº¡n vÃ  danh sÃ¡ch phiáº¿u báº£o hÃ nh tá»± Ä‘á»™ng refresh
- **Lá»‹ch sá»­**: LÆ°u thá»i gian duyá»‡t/tá»« chá»‘i

## Cáº¥u trÃºc dá»¯ liá»‡u

### Renewal Request
```json
{
  "id": "KH001",
  "name": "Nguyá»…n VÄƒn An", 
  "days": 30,
  "amount": 200000,
  "content": "Gia háº¡n báº£o hÃ nh 30 ngÃ y",
  "billUrl": "https://example.com/bill.jpg",
  "status": "pending|approved|rejected",
  "createdAt": 1234567890,
  "approvedAt": 1234567890,
  "rejectedAt": 1234567890,
  "updatedWarranties": 2
}
```

### Warranty Record (sau khi gia háº¡n)
```json
{
  "id": "KH001",
  "name": "Nguyá»…n VÄƒn An",
  "title": "Báº£o hÃ nh Ä‘iá»‡n thoáº¡i iPhone 14",
  "start": "2024-01-15",
  "end": "2025-02-14",  // ÄÃ£ Ä‘Æ°á»£c cá»™ng thÃªm 30 ngÃ y
  "image": "https://example.com/warranty.jpg"
}
```

## Test vÃ  Debug

### 1. Sá»­ dá»¥ng Test Tool
- Má»Ÿ `test-renewal-system.html`
- Táº¡o dá»¯ liá»‡u test
- Test quy trÃ¬nh duyá»‡t gia háº¡n
- Kiá»ƒm tra káº¿t quáº£

### 2. Debug trong Console
```javascript
// Xem táº¥t cáº£ yÃªu cáº§u gia háº¡n
console.log(window.adminExtras.renewals);

// Xem táº¥t cáº£ phiáº¿u báº£o hÃ nh
console.log(window.allWarranties);

// Test function duyá»‡t gia háº¡n
approveRenewal(0); // Duyá»‡t yÃªu cáº§u Ä‘áº§u tiÃªn
```

### 3. Kiá»ƒm tra káº¿t quáº£
- VÃ o trang `index.html` Ä‘á»ƒ xem phiáº¿u báº£o hÃ nh cá»§a khÃ¡ch
- Kiá»ƒm tra ngÃ y káº¿t thÃºc Ä‘Ã£ Ä‘Æ°á»£c cá»™ng thÃªm chÆ°a
- XÃ¡c nháº­n táº¥t cáº£ phiáº¿u báº£o hÃ nh cá»§a khÃ¡ch Ä‘á»u Ä‘Æ°á»£c gia háº¡n

## LÆ°u Ã½ quan trá»ng

### 1. Logic gia háº¡n
- **Táº¥t cáº£ phiáº¿u**: Gia háº¡n Táº¤T Cáº¢ phiáº¿u báº£o hÃ nh cá»§a khÃ¡ch hÃ ng
- **Cá»™ng ngÃ y**: NgÃ y káº¿t thÃºc má»›i = ngÃ y cÅ© + sá»‘ ngÃ y gia háº¡n
- **KhÃ´ng ghi Ä‘Ã¨**: Chá»‰ cá»™ng thÃªm, khÃ´ng thay tháº¿ ngÃ y gá»‘c

### 2. Xá»­ lÃ½ lá»—i
- **KhÃ´ng tÃ¬m tháº¥y phiáº¿u**: Hiá»ƒn thá»‹ thÃ´ng bÃ¡o lá»—i rÃµ rÃ ng
- **Dá»¯ liá»‡u khÃ´ng há»£p lá»‡**: Validate trÆ°á»›c khi xá»­ lÃ½
- **Lá»—i lÆ°u database**: Rollback vÃ  thÃ´ng bÃ¡o lá»—i

### 3. Performance
- **Batch update**: Cáº­p nháº­t táº¥t cáº£ phiáº¿u trong 1 láº§n
- **UI feedback**: Hiá»ƒn thá»‹ loading vÃ  káº¿t quáº£
- **Auto refresh**: Tá»± Ä‘á»™ng cáº­p nháº­t UI sau khi xá»­ lÃ½

## Troubleshooting

### Váº¥n Ä‘á»: "KhÃ´ng tÃ¬m tháº¥y phiáº¿u báº£o hÃ nh"
**NguyÃªn nhÃ¢n**: Customer ID khÃ´ng khá»›p
**Giáº£i phÃ¡p**: 
- Kiá»ƒm tra Customer ID trong yÃªu cáº§u gia háº¡n
- Kiá»ƒm tra Customer ID trong phiáº¿u báº£o hÃ nh
- Äáº£m báº£o format ID nháº¥t quÃ¡n

### Váº¥n Ä‘á»: "Chá»‰ 1 phiáº¿u Ä‘Æ°á»£c gia háº¡n"
**NguyÃªn nhÃ¢n**: Logic cÅ© chá»‰ tÃ¬m phiáº¿u Ä‘áº§u tiÃªn
**Giáº£i phÃ¡p**: ÄÃ£ sá»­a trong code má»›i, sá»­ dá»¥ng `filter()` thay vÃ¬ `find()`

### Váº¥n Ä‘á»: "NgÃ y khÃ´ng Ä‘Æ°á»£c cá»™ng Ä‘Ãºng"
**NguyÃªn nhÃ¢n**: Lá»—i tÃ­nh toÃ¡n ngÃ y
**Giáº£i phÃ¡p**: 
- Kiá»ƒm tra format ngÃ y (YYYY-MM-DD)
- Kiá»ƒm tra logic cá»™ng ngÃ y
- Test vá»›i dá»¯ liá»‡u máº«u

## Káº¿t luáº­n

Váº¥n Ä‘á» **"khi duyá»‡t Ä‘Æ¡n yÃªu cáº§u gia háº¡n sao khÃ´ng cá»™ng ngÃ y báº£o hÃ nh cho khÃ¡ch"** Ä‘Ã£ Ä‘Æ°á»£c giáº£i quyáº¿t hoÃ n toÃ n:

- âœ… **TÃ¬m táº¥t cáº£ phiáº¿u báº£o hÃ nh** cá»§a khÃ¡ch hÃ ng
- âœ… **Cá»™ng ngÃ y cho táº¥t cáº£ phiáº¿u** báº£o hÃ nh
- âœ… **UI cáº£i thiá»‡n** vá»›i status badges vÃ  action buttons
- âœ… **ThÃªm chá»©c nÄƒng tá»« chá»‘i** gia háº¡n
- âœ… **ThÃ´ng bÃ¡o chi tiáº¿t** vá» káº¿t quáº£
- âœ… **Test tool** Ä‘á»ƒ kiá»ƒm tra chá»©c nÄƒng
- âœ… **Error handling** vÃ  validation

Há»‡ thá»‘ng bÃ¢y giá» sáº½ tá»± Ä‘á»™ng cá»™ng ngÃ y báº£o hÃ nh cho Táº¤T Cáº¢ phiáº¿u báº£o hÃ nh cá»§a khÃ¡ch hÃ ng khi admin duyá»‡t yÃªu cáº§u gia háº¡n.
